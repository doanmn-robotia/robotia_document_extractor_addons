<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_extraction_review_wizard_form" model="ir.ui.view">
        <field name="name">extraction.review.wizard.form</field>
        <field name="model">extraction.review.wizard</field>
        <field name="arch" type="xml">
            <form string="Review Extracted Data" js_class="document_extraction_form" class="o_form_extraction_split o_form_extraction_review">
                <sheet>
                    <!-- Validation Statistics Widget -->
                    <widget name="validation_stats_widget" class="mb-3"/>
                    
                    <group string="Document Info" colspan="2">
                        <group>
                            <div col="1" colspan="2">
                                <label for="document_type"/>
                                <field name="document_type" nolabel="1" colspan="2"/>
                            </div>
                        </group>
                        <group>
                            <div col="1" colspan="2">
                                <label for="year"/>
                                <field name="year" nolabel="1" colspan="2"/>
                            </div>
                        </group>
                    </group>
                    
                    <!-- Metadata: Organization -->
                    <group string="Organization Information">
                        <group string="RAW Data (OCR)" class="bg-light">
                            <div col="1" colspan="2">
                                <label for="organization_name_raw"/>
                                <field name="organization_name_raw" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="business_license_number_raw"/>
                                <field name="business_license_number_raw" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="business_license_date_raw"/>
                                <field name="business_license_date_raw" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="business_license_place_raw"/>
                                <field name="business_license_place_raw" nolabel="1" colspan="2"/>
                            </div>
                        </group>
                        <group string="Normalized Data">
                            <div col="1" colspan="2">
                                <label for="organization_name"/>
                                <field name="organization_name" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="business_license_number"/>
                                <field name="business_license_number" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="business_license_date"/>
                                <field name="business_license_date" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="business_license_place"/>
                                <field name="business_license_place" nolabel="1" colspan="2"/>
                            </div>
                        </group>
                    </group>
                    
                    <!-- Metadata: Representative -->
                    <group string="Legal Representative">
                        <group string="RAW Data (OCR)" class="bg-light">
                            <div col="1" colspan="2">
                                <label for="legal_representative_name_raw"/>
                                <field name="legal_representative_name_raw" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="legal_representative_position_raw"/>
                                <field name="legal_representative_position_raw" nolabel="1" colspan="2"/>
                            </div>
                        </group>
                        <group string="Normalized Data">
                            <div col="1" colspan="2">
                                <label for="legal_representative_name"/>
                                <field name="legal_representative_name" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="legal_representative_position"/>
                                <field name="legal_representative_position" nolabel="1" colspan="2"/>
                            </div>
                        </group>
                    </group>
                    
                    <!-- Metadata: Contact -->
                    <group string="Contact Information">
                        <group string="RAW Data (OCR)" class="bg-light">
                            <div col="1" colspan="2">
                                <label for="contact_person_name_raw"/>
                                <field name="contact_person_name_raw" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="contact_address_raw"/>
                                <field name="contact_address_raw" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="contact_phone_raw"/>
                                <field name="contact_phone_raw" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="contact_fax_raw"/>
                                <field name="contact_fax_raw" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="contact_email_raw"/>
                                <field name="contact_email_raw" nolabel="1" colspan="2"/>
                            </div>
                        </group>
                        <group string="Normalized Data">
                            <div col="1" colspan="2">
                                <label for="contact_person_name"/>
                                <field name="contact_person_name" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="contact_address"/>
                                <field name="contact_address" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="contact_phone"/>
                                <field name="contact_phone" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="contact_fax"/>
                                <field name="contact_fax" nolabel="1" colspan="2"/>
                            </div>
                            <div col="1" colspan="2">
                                <label for="contact_email"/>
                                <field name="contact_email" nolabel="1" colspan="2"/>
                            </div>
                        </group>
                    </group>
                    
                    <notebook>
                        <!-- Form 01 Tables -->
                        <page string="Substance Usage" invisible="document_type != '01'">
                            <field name="substance_usage_ids">
                                <list editable="bottom">
                                    <field name="sequence" widget="handle"/>
                                    <field name="usage_type_raw" readonly="1" optional="hide" decoration-muted="1"/>
                                    <field name="usage_type"/>
                                    <field name="substance_name_raw" readonly="1" optional="show" decoration-muted="1"/>
                                    <field name="substance_name"/>
                                    <field name="year_1_quantity_kg_raw" readonly="1" optional="hide" decoration-muted="1"/>
                                    <field name="year_1_quantity_kg"/>
                                    <field name="year_2_quantity_kg"/>
                                    <field name="year_3_quantity_kg"/>
                                </list>
                            </field>
                        </page>
                        <page string="Equipment/Product" invisible="document_type != '01'">
                            <field name="equipment_product_ids">
                                <list editable="bottom">
                                    <field name="sequence" widget="handle"/>
                                    <field name="product_type_raw" readonly="1" optional="show" decoration-muted="1"/>
                                    <field name="product_type"/>
                                    <field name="hs_code"/>
                                    <field name="quantity_raw" readonly="1" optional="hide" decoration-muted="1"/>
                                    <field name="quantity"/>
                                    <field name="substance_name"/>
                                </list>
                            </field>
                        </page>
                        <page string="Equipment Ownership" invisible="document_type != '01'">
                            <field name="equipment_ownership_ids">
                                <list editable="bottom">
                                    <field name="sequence" widget="handle"/>
                                    <field name="product_type_raw" readonly="1" optional="show" decoration-muted="1"/>
                                    <field name="product_type"/>
                                    <field name="quantity_raw" readonly="1" optional="hide" decoration-muted="1"/>
                                    <field name="quantity"/>
                                    <field name="substance_name"/>
                                </list>
                            </field>
                        </page>
                        <page string="Collection &amp; Recycling" invisible="document_type != '01'">
                            <field name="collection_recycling_ids">
                                <list editable="bottom">
                                    <field name="sequence" widget="handle"/>
                                    <field name="activity_type"/>
                                    <field name="substance_name_raw" readonly="1" optional="show" decoration-muted="1"/>
                                    <field name="substance_name"/>
                                    <field name="quantity_kg_raw" readonly="1" optional="hide" decoration-muted="1"/>
                                    <field name="quantity_kg"/>
                                    <field name="facility_name"/>
                                </list>
                            </field>
                        </page>

                        <!-- Form 02 Tables -->
                        <page string="Quota Usage" invisible="document_type != '02'">
                            <field name="quota_usage_ids">
                                <list editable="bottom">
                                    <field name="sequence" widget="handle"/>
                                    <field name="usage_type_raw" readonly="1" optional="hide" decoration-muted="1"/>
                                    <field name="usage_type"/>
                                    <field name="substance_name_raw" readonly="1" optional="show" decoration-muted="1"/>
                                    <field name="substance_name"/>
                                    <field name="allocated_quota_kg_raw" readonly="1" optional="hide" decoration-muted="1"/>
                                    <field name="allocated_quota_kg"/>
                                    <field name="total_quota_kg_raw" readonly="1" optional="hide" decoration-muted="1"/>
                                    <field name="total_quota_kg"/>
                                </list>
                            </field>
                        </page>
                        <page string="Equipment/Product Report" invisible="document_type != '02'">
                            <field name="equipment_product_report_ids">
                                <list editable="bottom">
                                    <field name="sequence" widget="handle"/>
                                    <field name="production_type"/>
                                    <field name="product_type_raw" readonly="1" optional="show" decoration-muted="1"/>
                                    <field name="product_type"/>
                                    <field name="hs_code"/>
                                    <field name="quantity_raw" readonly="1" optional="hide" decoration-muted="1"/>
                                    <field name="quantity"/>
                                    <field name="substance_name"/>
                                </list>
                            </field>
                        </page>
                        <page string="Equipment Ownership Report" invisible="document_type != '02'">
                            <field name="equipment_ownership_report_ids">
                                <list editable="bottom">
                                    <field name="sequence" widget="handle"/>
                                    <field name="ownership_type"/>
                                    <field name="equipment_type_raw" readonly="1" optional="show" decoration-muted="1"/>
                                    <field name="equipment_type"/>
                                    <field name="equipment_quantity_raw" readonly="1" optional="hide" decoration-muted="1"/>
                                    <field name="equipment_quantity"/>
                                    <field name="substance_name"/>
                                </list>
                            </field>
                        </page>
                        <page string="Collection &amp; Recycling Report" invisible="document_type != '02'">
                            <field name="collection_recycling_report_ids">
                                <list editable="bottom">
                                    <field name="substance_name_raw" readonly="1" optional="show" decoration-muted="1"/>
                                    <field name="substance_name"/>
                                    <field name="collection_quantity_kg_raw" readonly="1" optional="hide" decoration-muted="1"/>
                                    <field name="collection_quantity_kg"/>
                                    <field name="collection_location"/>
                                </list>
                            </field>
                        </page>
                    </notebook>
                    
                    <footer>
                        <button name="action_approve" string="Approve &amp; Create" type="object" class="btn-primary"/>
                        <button string="Cancel" class="btn-secondary" special="cancel"/>
                    </footer>
                </sheet>
                
                <!-- PDF Preview Container (will be extracted by FormCompiler) -->
                <div class="o_pdf_preview">
                    <notebook>
                        <page name="pdf_preview" string="PDF Document Preview">
                            <div class="o_pdf_preview_content">
                                <field name="pdf_file" widget="pdf_viewer" options="{'height': '100%'}"/>
                            </div>
                        </page>
                    </notebook>
                </div>
            </form>
        </field>
    </record>
</odoo>

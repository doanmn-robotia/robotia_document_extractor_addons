<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ========================================== -->
    <!-- Master Data Actions -->
    <!-- ========================================== -->

    <!-- Controlled Substances -->
    <record id="view_controlled_substance_list" model="ir.ui.view">
        <field name="name">controlled.substance.list</field>
        <field name="model">controlled.substance</field>
        <field name="arch" type="xml">
            <list string="Controlled Substances">
                <field name="name"/>
                <field name="code"/>
                <field name="hs_code_id" options="{'no_create': True}"/>
                <field name="formula"/>
                <field name="cas_number"/>
                <field name="form_type"/>
                <field name="gwp"/>
                <field name="active" column_invisible="1"/>
                <button name="action_view_dashboard" type="object" string="Dashboard" icon="fa-bar-chart"/>
            </list>
        </field>
    </record>

    <record id="view_controlled_substance_form" model="ir.ui.view">
        <field name="name">controlled.substance.form</field>
        <field name="model">controlled.substance</field>
        <field name="arch" type="xml">
            <form string="Controlled Substance">
                <header>
                    <button name="action_view_dashboard"
                            type="object"
                            string="Dashboard"
                            class="btn-primary"
                            icon="fa-bar-chart"
                            help="View analytics dashboard for this substance"/>
                </header>
                <sheet>
                    <group>
                        <group>
                            <field name="name" required="1"/>
                            <field name="code"/>
                            <field name="formula"/>
                            <field name="hs_code_id" options="{'no_create': True}"/>
                            <field name="sub_hs_code_ids" widget="many2many_tags" options="{'no_create': True}"/>
                        </group>
                        <group>
                            <field name="cas_number"/>
                            <field name="form_type"/>
                            <field name="gwp"/>
                            <field name="active"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="action_controlled_substance" model="ir.actions.act_window">
        <field name="name">Controlled Substances</field>
        <field name="res_model">controlled.substance</field>
        <field name="view_mode">list,form</field>
    </record>

    <!-- Activity Fields -->
    <record id="view_activity_field_list" model="ir.ui.view">
        <field name="name">activity.field.list</field>
        <field name="model">activity.field</field>
        <field name="arch" type="xml">
            <list string="Activity Fields" editable="bottom">
                <field name="sequence" widget="handle" options="{'enable_formatting': false}"/>
                <field name="name"/>
                <field name="code"/>
                <field name="description"/>
                <field name="active"/>
            </list>
        </field>
    </record>

    <record id="action_activity_field" model="ir.actions.act_window">
        <field name="name">Activity Fields</field>
        <field name="res_model">activity.field</field>
        <field name="view_mode">list,form</field>
    </record>

    <!-- ========================================== -->
    <!-- Dashboard Client Actions -->
    <!-- ========================================== -->
    <record id="action_dashboard" model="ir.actions.client">
        <field name="name">Ingestion</field>
        <field name="tag">document_extractor.dashboard</field>
    </record>

    <!-- Overview Dashboard -->
    <record id="action_overview_dashboard" model="ir.actions.client">
        <field name="name">Overview Dashboard</field>
        <field name="tag">document_extractor.overview_dashboard</field>
    </record>

    <!-- HFC Dashboard (Reports & Analysis) -->
    <record id="action_hfc_dashboard" model="ir.actions.client">
        <field name="name">Reports &amp; Analysis</field>
        <field name="tag">document_extractor.hfc_dashboard</field>
    </record>

    <!-- ChatBot -->
    <record id="action_chatbot" model="ir.actions.client">
        <field name="name">AI Assistant</field>
        <field name="tag">document_extractor.chatbot</field>
    </record>

    <!-- ========================================== -->
    <!-- Settings Action (Placeholder) -->
    <!-- ========================================== -->
    <record id="action_document_extractor_settings" model="ir.actions.act_window">
        <field name="name">Document Extractor Settings</field>
        <field name="res_model">res.config.settings</field>
        <field name="view_mode">form</field>
        <field name="target">inline</field>
        <field name="context">{'module': 'robotia_document_extractor'}</field>
    </record>


        <!-- Root Menu -->
    <menuitem id="menu_document_extractor_root"
              name="Document Extractor"
              web_icon="robotia_document_extractor,static/description/icon.png"
              sequence="10"/>

    <!-- Dashboard Menu (mapped to Overview Dashboard) -->
    <menuitem id="menu_dashboard"
              name="Dashboard"
              parent="menu_document_extractor_root"
              action="action_overview_dashboard"
              sequence="1"/>

    <!-- Ingestion Menu (mapped to Overview Dashboard) -->
    <menuitem id="menu_overview_dashboard"
              name="Ingestion"
              parent="menu_document_extractor_root"
              action="action_dashboard"
              sequence="2"/>

    <!-- Documents Menu -->
    <menuitem id="menu_documents"
              name="Documents"
              parent="menu_document_extractor_root"
              sequence="3"/>

    <menuitem id="menu_all_documents"
              name="All Documents"
              parent="menu_documents"
              action="action_document_extraction_all"
              sequence="1"/>

    <menuitem id="menu_registrations"
              name="Registrations (Form 01)"
              parent="menu_documents"
              action="action_document_extraction_registration"
              sequence="2"/>

    <menuitem id="menu_form02_reports"
              name="Reports (Form 02)"
              parent="menu_documents"
              action="action_document_extraction_report"
              sequence="3"/>

    <menuitem id="menu_reports"
              name="Reports"
              parent="menu_document_extractor_root"
              action="action_hfc_dashboard"
              sequence="4"/>

    <!-- Master Data Menu -->
    <menuitem id="menu_master_data"
              name="Lookup &amp; Summary"
              parent="menu_document_extractor_root"
              sequence="20"/>

    <menuitem id="menu_controlled_substances"
              name="Controlled Substances"
              parent="menu_master_data"
              action="action_controlled_substance"
              sequence="1"/>

    <menuitem id="menu_activity_fields"
              name="Activity Fields"
              parent="menu_master_data"
              action="action_activity_field"
              sequence="2"/>

    <menuitem id="menu_equipment_types"
              name="Equipment Types"
              parent="menu_master_data"
              action="action_equipment_type"
              sequence="3"/>

    <menuitem id="menu_hs_codes"
              name="HS Codes"
              parent="menu_master_data"
              action="action_hs_code"
              sequence="4"/>

    <menuitem id="menu_recycling_technologies"
              name="Recycling Technologies"
              parent="menu_master_data"
              action="action_recycling_technology"
              sequence="5"/>

    <menuitem id="menu_recycling_facilities"
              name="Recycling Facilities"
              parent="menu_master_data"
              action="action_recycling_facility"
              sequence="6"/>

    <menuitem id="menu_collection_locations"
              name="Collection Locations"
              parent="menu_master_data"
              action="action_collection_location"
              sequence="7"/>

    <!-- Configuration Menu -->
    <menuitem id="menu_configuration"
              name="Configuration"
              parent="menu_document_extractor_root"
              sequence="90"
              groups="base.group_system"/>

    <menuitem id="menu_settings"
              name="Settings"
              parent="menu_configuration"
              action="action_document_extractor_settings"
              sequence="1"
              groups="base.group_system"/>

    <!-- ========================================== -->
    <!-- Partner (Organization) Custom Views -->
    <!-- ========================================== -->

    <!-- Custom Organization List View -->
    <record id="view_partner_organization_list" model="ir.ui.view">
        <field name="name">res.partner.organization.list</field>
        <field name="model">res.partner</field>
        <field name="priority">20</field>
        <field name="arch" type="xml">
            <list string="Organizations">
                <field name="name"/>
                <field name="business_license_number"/>
                <field name="city"/>
                <field name="country_id" optional="hide"/>
                <field name="phone"/>
                <field name="email"/>
                <field name="legal_representative_name" optional="hide"/>
                <button name="action_view_dashboard" type="object" string="Dashboard" icon="fa-bar-chart"/>
            </list>
        </field>
    </record>

    <!-- Custom Organization Form View -->
    <record id="view_partner_organization_form" model="ir.ui.view">
        <field name="name">res.partner.organization.form</field>
        <field name="model">res.partner</field>
        <field name="priority">20</field>
        <field name="arch" type="xml">
            <form string="Organization">
                <header>
                    <button name="action_view_dashboard"
                            type="object"
                            string="Dashboard"
                            class="btn-primary"
                            icon="fa-bar-chart"
                            help="View analytics dashboard for this organization"/>
                </header>
                <sheet>
                    <field name="x_partner_type" invisible="1"/>
                    <field name="image_1920" widget="image" class="oe_avatar"/>
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Organization Name" required="1"/>
                        </h1>
                    </div>

                    <group>
                        <group string="Business License">
                            <field name="business_license_number"/>
                            <field name="business_license_date"/>
                            <field name="business_license_place"/>
                        </group>
                        <group string="Contact Information">
                            <field name="phone"/>
                            <field name="mobile" optional="hide"/>
                            <field name="email"/>
                            <field name="fax"/>
                        </group>
                    </group>

                    <group>
                        <group string="Address">
                            <field name="street" placeholder="Street..."/>
                            <field name="street2" placeholder="Street 2..."/>
                            <field name="city"/>
                            <field name="state_id"/>
                            <field name="zip"/>
                            <field name="country_id"/>
                        </group>
                        <group string="Legal Representative">
                            <field name="legal_representative_name"/>
                            <field name="legal_representative_position"/>
                            <field name="contact_person_name"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Internal Notes">
                            <field name="comment" placeholder="Internal notes..."/>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Custom Organization Search View -->
    <record id="view_partner_organization_search" model="ir.ui.view">
        <field name="name">res.partner.organization.search</field>
        <field name="model">res.partner</field>
        <field name="priority">20</field>
        <field name="arch" type="xml">
            <search string="Search Organizations">
                <field name="name"/>
                <field name="business_license_number"/>
                <field name="legal_representative_name"/>
                <field name="city"/>
                <field name="country_id"/>
                <filter string="Has Business License" name="has_license"
                        domain="[('business_license_number', '!=', False)]"/>
                <separator/>
                <filter string="Companies" name="is_company"
                        domain="[('is_company', '=', True)]"/>
                <group expand="0" string="Group By">
                    <filter string="City" name="group_by_city" context="{'group_by': 'city'}"/>
                    <filter string="Country" name="group_by_country" context="{'group_by': 'country_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Organization Action -->
    <record id="action_partner_organization" model="ir.actions.act_window">
        <field name="name">Organizations</field>
        <field name="res_model">res.partner</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('is_company', '=', True), ('x_partner_type', '=', 'organization')]</field>
        <field name="context">{'default_is_company': True, 'default_x_partner_type': 'organization', 'search_default_has_license': 1}</field>
        <field name="view_ids" eval="[(5, 0, 0),
            (0, 0, {'view_mode': 'list', 'view_id': ref('view_partner_organization_list')}),
            (0, 0, {'view_mode': 'form', 'view_id': ref('view_partner_organization_form')})]"/>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create your first Organization
            </p>
            <p>
                Organizations are automatically created when you extract documents.
                You can also create them manually here.
            </p>
        </field>
    </record>

    <!-- Add menu for Organizations -->
    <menuitem id="menu_organizations"
              name="Organizations"
              parent="menu_master_data"
              action="action_partner_organization"
              sequence="0"/>

    <!-- ========================================== -->
    <!-- Recovery Dashboard Client Action -->
    <!-- ========================================== -->
    <record id="action_recovery_dashboard" model="ir.actions.client">
        <field name="name">Collection &amp; Recycling Dashboard</field>
        <field name="tag">document_extractor.recovery_dashboard</field>
    </record>

    <menuitem id="menu_recovery_dashboard"
              name="Collection &amp; Recycling"
              parent="menu_master_data"
              action="action_recovery_dashboard"
              sequence="9"/>


</odoo>

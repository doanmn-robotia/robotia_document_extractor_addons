<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <!-- Main Dashboard Template -->
    <t t-name="robotia_document_extractor.Dashboard">
        <div class="o_document_extractor_dashboard">
            <div class="dashboard-header">
                <h1><i class="fa fa-file-pdf-o me-2"/>Document Extractor</h1>
                <p class="text-muted">AI-powered extraction for Vietnamese controlled substance reports</p>
            </div>

            <div t-if="state.loading" class="text-center py-5">
                <i class="fa fa-spinner fa-spin fa-3x text-primary"/>
                <p class="mt-3">Loading dashboard...</p>
            </div>

            <div t-else="">
                <!-- Upload Area -->
                <UploadArea onExtractionComplete.bind="onExtractionComplete"/>

                <!-- Statistics Cards -->
                <div class="statistics-cards mt-4">
                    <StatisticsCard
                        title.translate="Registrations"
                        count="state.statistics.registrations"
                        docType="'01'"
                        onClick.bind="onCardClick"/>

                    <StatisticsCard
                        title.translate="Reports"
                        count="state.statistics.reports"
                        docType="'02'"
                        onClick.bind="onCardClick"/>
                </div>

                <!-- Recent Extractions -->
                <RecentExtractions class="'mt-4'"/>
            </div>
        </div>
    </t>

    <!-- Upload Area Template -->
    <t t-name="robotia_document_extractor.UploadArea">
        <div class="upload-area-container">
            <div class="upload-area"
                 t-att-class="state.dragOver ? 'drag-over' : ''"
                 t-on-dragover="onDragOver"
                 t-on-dragleave="onDragLeave"
                 t-on-drop="onDrop">

                <div class="upload-content">
                    <div t-if="!state.uploading">
                        <i class="fa fa-cloud-upload fa-4x text-primary"/>
                        <h3 class="mt-3">Drag &amp; Drop PDF File</h3>
                        <p class="text-muted">or click to browse</p>

                        <label class="btn btn-primary btn-lg mt-2">
                            <i class="fa fa-folder-open me-2"/>Browse Files
                            <input type="file"
                                   accept=".pdf,application/pdf"
                                   t-on-change="onFileSelect"
                                   style="display:none"/>
                        </label>

                        <div class="document-type-selector mt-4">
                            <label class="form-label fw-bold">Document Type:</label>
                            <div class="btn-group w-100" role="group">
                                <input type="radio"
                                       class="btn-check"
                                       name="documentType"
                                       id="docType01"
                                       value="01"
                                       checked="checked"
                                       t-on-change="onDocumentTypeChange"/>
                                <label class="btn btn-outline-primary" for="docType01">
                                    <i class="fa fa-file-text me-1"/>Form 01 - Registration
                                </label>

                                <input type="radio"
                                       class="btn-check"
                                       name="documentType"
                                       id="docType02"
                                       value="02"
                                       t-on-change="onDocumentTypeChange"/>
                                <label class="btn btn-outline-primary" for="docType02">
                                    <i class="fa fa-bar-chart me-1"/>Form 02 - Report
                                </label>
                            </div>
                        </div>

                        <div class="upload-info mt-3">
                            <small class="text-muted">
                                <i class="fa fa-info-circle me-1"/>
                                Supported format: PDF | Max size: 50MB
                            </small>
                        </div>
                    </div>

                    <div t-else="" class="uploading-state text-center py-4">
                        <i class="fa fa-spinner fa-spin fa-3x text-primary"/>
                        <h4 class="mt-3">Extracting Document...</h4>
                        <p class="text-muted">Please wait while AI processes your document</p>
                    </div>
                </div>
            </div>
        </div>
    </t>

    <!-- Statistics Card Template -->
    <t t-name="robotia_document_extractor.StatisticsCard">
        <div class="stat-card" t-on-click="handleClick">
            <div class="stat-card-icon">
                <i t-att-class="props.docType === '01' ? 'fa fa-file-text fa-2x' : 'fa fa-bar-chart fa-2x'"/>
            </div>
            <div class="stat-card-content">
                <h3 class="stat-card-title"><t t-esc="props.title"/></h3>
                <div class="stat-card-count"><t t-esc="props.count"/></div>
                <div class="stat-card-footer">
                    <span class="text-muted">
                        <t t-if="props.docType === '01'">Registration forms</t>
                        <t t-else="">Report forms</t>
                    </span>
                </div>
            </div>
        </div>
    </t>

    <!-- Recent Extractions Template -->
    <t t-name="robotia_document_extractor.RecentExtractions">
        <div class="recent-extractions-container">
            <div class="section-header">
                <h2><i class="fa fa-history me-2"/>Recent Extractions</h2>
            </div>

            <div t-if="state.loading" class="text-center py-3">
                <i class="fa fa-spinner fa-spin fa-2x text-muted"/>
            </div>

            <div t-elif="state.recentDocuments.length === 0" class="text-center py-5">
                <i class="fa fa-inbox fa-3x text-muted"/>
                <p class="mt-3 text-muted">No documents extracted yet</p>
            </div>

            <div t-else="" class="recent-list">
                <div t-foreach="state.recentDocuments" t-as="doc" t-key="doc.id"
                     class="recent-item"
                     t-on-click="() => this.openDocument(doc.id)">

                    <div class="recent-item-icon">
                        <i t-att-class="doc.document_type === '01' ? 'fa fa-file-text-o fa-2x' : 'fa fa-bar-chart fa-2x'"/>
                    </div>

                    <div class="recent-item-content">
                        <h4 class="recent-item-title">
                            <t t-esc="doc.name"/>
                        </h4>
                        <div class="recent-item-meta">
                            <span class="me-3">
                                <i class="fa fa-building-o me-1"/>
                                <t t-esc="doc.organization_id[1]"/>
                            </span>
                            <span class="me-3">
                                <i class="fa fa-calendar me-1"/>
                                <t t-esc="doc.year"/>
                            </span>
                            <span>
                                <i class="fa fa-clock-o me-1"/>
                                <t t-esc="formatDate(doc.extraction_date)"/>
                            </span>
                        </div>
                    </div>

                    <div class="recent-item-badge">
                        <span t-att-class="getStateBadgeClass(doc.state)">
                            <t t-esc="getStateLabel(doc.state)"/>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </t>

</templates>

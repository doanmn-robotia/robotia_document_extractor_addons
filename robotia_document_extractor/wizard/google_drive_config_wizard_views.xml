<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Google Drive Configuration Wizard Form -->
    <record id="google_drive_config_wizard_form" model="ir.ui.view">
        <field name="name">google.drive.config.wizard.form</field>
        <field name="model">google.drive.config.wizard</field>
        <field name="arch" type="xml">
            <form string="Configure Google Drive">
                <group>
                    <field name="service_account_file"
                            filename="service_account_filename"
                            widget="binary"/>
                    <field name="service_account_filename" invisible="1"/>
                </group>
                <group>
                    <field name="folder_id" placeholder="Leave empty for all Drive"/>
                </group>

                <div class="alert alert-info">
                    <h4>How to get your Service Account JSON file:</h4>
                    <ol>
                        <li>Go to <a href="https://console.cloud.google.com/iam-admin/serviceaccounts" target="_blank">Google Cloud Console → IAM &amp; Admin → Service Accounts</a></li>
                        <li>Create a new service account or select an existing one</li>
                        <li>Enable the <strong>Google Drive API</strong> for your project:
                            <ul>
                                <li>Go to <a href="https://console.cloud.google.com/apis/library/drive.googleapis.com" target="_blank">APIs &amp; Services → Library</a></li>
                                <li>Search for "Google Drive API" and enable it</li>
                            </ul>
                        </li>
                        <li>Back in Service Accounts, click <strong>Keys → Add Key → Create New Key → JSON</strong></li>
                        <li>Download the JSON file (it will be named like <code>project-name-123abc.json</code>)</li>
                        <li><strong>Upload that file here</strong></li>
                        <li>Copy the service account email (e.g., <code>my-service@project.iam.gserviceaccount.com</code>)</li>
                        <li>Share your Google Drive folder with that email address (give "Viewer" or "Editor" permission)</li>
                        <li>Get the folder ID from the URL: <code>https://drive.google.com/drive/folders/<strong>FOLDER_ID</strong></code></li>
                        <li>Enter the folder ID above (or leave empty to access all Drive)</li>
                    </ol>
                </div>
                <footer>
                    <button string="Save Configuration"
                            name="action_configure"
                            type="object"
                            class="btn btn-primary"
                            data-hotkey="q"/>
                    <button string="Save &amp; Test Connection"
                            name="action_test_connection"
                            type="object"
                            class="btn btn-secondary p-2"
                            data-hotkey="t"/>
                    <button string="Clear Config"
                            name="action_clear_config"
                            type="object"
                            class="btn btn-secondary p-2"
                            confirm="Are you sure you want to clear the Google Drive configuration?"/>
                    <button string="Cancel"
                            class="btn btn-secondary"
                            special="cancel"
                            data-hotkey="z"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Action to open the wizard -->
    <record id="action_google_drive_config_wizard" model="ir.actions.act_window">
        <field name="name">Configure Google Drive</field>
        <field name="res_model">google.drive.config.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>
</odoo>
